//! locus
//! version : 0.1.0
//! author  : Tal Ater @TalAter
//! license : MIT
//! https://github.com/TalAter/locus
(function(a){"use strict";var b=this,c=navigator.geolocation;if(!c)return b.Locus=null,a;var d,e={},f=function(a){for(var b in e)if(e.hasOwnProperty(b)){var c=e[b],d=i(a.coords,c);d&&(c.inhabited||c.fn()),c.inhabited=d}},g=Math.PI/180,h=function(a,b){var c=a.latitude,d=b.latitude,e=a.longitude,f=b.longitude,h=6371,i=c*g,j=d*g,k=(d-c)*g,l=(f-e)*g,m=Math.sin(k/2)*Math.sin(k/2)+Math.cos(i)*Math.cos(j)*Math.sin(l/2)*Math.sin(l/2),n=2*Math.atan2(Math.sqrt(m),Math.sqrt(1-m));return h*n},i=function(a,b){return 1e3*h(a,b.coords)<=b.radius},j=function(a){return a=a.replace(/[^\d\,\-\.]/,""),a=a.split(","),{latitude:parseFloat(a[0]),longitude:parseFloat(a[1])}},k=function(a){return parseFloat(a.replace(/[^\d\,\-\.]/,""))};b.Locus={addFences:function(a){for(var b in a)if(a.hasOwnProperty(b)){var c=a[b];e[b]={coords:j(c.coords),radius:k(c.radius||"500m"),fn:c.fn,inhabited:!1}}},getFences:function(){return e},removeFences:function(b){return b===a?void(e={}):(b=Array.isArray(b)?b:[b],void b.forEach(function(a){delete e[a]}))},start:function(){return d?!1:(d=c.watchPosition(f),!0)}}}).call(this);